<!DOCTYPE html><html lang="es"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title id="t1">Convoyrama | Eventos</title><meta name="description" content="Convoyrama - Herramienta para horarios de convoys"><link rel="stylesheet" href="./assets/style.css"><link rel="icon" href="./assets/images/favicon.png"><link rel="apple-touch-icon" href="./assets/images/favicon.png"><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:Arial,sans-serif;min-height:100vh;display:flex;flex-direction:column;background:#333}header{padding:10px;text-align:center;background:#333;color:#fff}header p{font-size:1.2em;margin:5px 0;font-weight:normal}nav{padding:5px;text-align:center}nav a,nav a:visited{text-decoration:none;margin:0 10px;font-size:1em;color:#fff}nav a:hover{text-decoration:underline}.contenedor{padding:15px;max-width:1200px;margin:0 auto;flex:1}.timeline-container{margin-top:15px}.timeline-indicator{font-size:1em;font-weight:bold;text-align:center;margin-bottom:15px;padding:10px;background:linear-gradient(to right,#f0f0f0,#e0f0e0);border-radius:6px;border:2px solid rgb(90,165,25);color:rgb(90,165,25);position:relative}.timeline-indicator::after{content:'';position:absolute;bottom:-10px;left:50%;transform:translateX(-50%);border:5px solid transparent;border-top-color:rgb(90,165,25)}.slots-explanation{font-size:.9em;margin-bottom:15px;color:rgb(240,240,240);text-align:center}.timeline{display:flex;flex-wrap:wrap;gap:10px;padding:10px 0;justify-content:center}.slot{background:#f0f0f0;border-radius:10px;padding:10px;width:calc(100% / 7 - 10px);border:2px solid rgb(90,165,25);text-align:center;transition:transform .3s,border .3s,box-shadow .3s;box-shadow:0 2px 4px rgba(0,0,0,.1);cursor:pointer}.slot:hover{transform:translateY(-3px);box-shadow:0 4px 8px rgba(0,0,0,.2)}.slot.highlight{border:3px solid rgb(90,165,25);transform:scale(1.05);background:linear-gradient(to bottom,#e0f0e0,#d0e0d0);box-shadow:0 4px 12px rgba(0,0,0,.3)}.slot.selected{border:3px solid rgb(90,165,25);background:#d0e0d0;box-shadow:0 4px 12px rgba(0,0,0,.3)}.slot h4{margin:0 0 6px;font-size:1em;color:rgb(90,165,25)}.slot .event{font-size:.85em;margin:3px 0;color:rgb(90,165,25);font-weight:bold}.range-bar{height:6px;border-radius:4px;background:linear-gradient(to right,rgb(90,165,25),rgb(120,195,55));margin:8px 0;position:relative}.range-bar::after{content:"";position:absolute;top:-4px;right:-6px;width:12px;height:12px;border-radius:50%;background:#fff;border:1px solid rgb(90,165,25)}#timezone-select,#date-select,#event-name,#event-link,#event-description,#custom-date,#custom-time,#custom-event-name,#custom-event-link,#custom-event-description{padding:6px;margin:5px;font-size:.85em;border:2px solid rgb(90,165,25);border-radius:6px}#date-select,#custom-date,#custom-time{width:150px}#event-name,#event-link,#custom-event-name,#custom-event-link{width:45%}#event-description,#custom-event-description{width:100%;max-height:50px;resize:vertical;rows:2}.input-row{display:flex;gap:10px;align-items:center;flex-wrap:wrap;justify-content:flex-start}.time-info{display:flex;gap:15px;justify-content:center;align-items:center;margin:5px 0;font-size:.9em;color:rgb(240,240,240)}#date-display,#current-user-time{font-size:.9em;color:rgb(90,165,25);text-align:center}.event-timeline{margin-top:20px;padding:15px;background:#f0f0f0;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,.1)}.custom-event{margin-top:20px;padding:15px;background:#333;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,.1)}.event-timeline h3,.custom-event h3{font-size:1em;color:rgb(90,165,25);text-align:center;margin-bottom:10px}.custom-event label{color:#fff;font-size:.9em;margin-right:5px}.timeline-bar{display:flex;height:20px;background:#ddd;border-radius:4px;position:relative;overflow:hidden}.timeline-segment{height:100%;display:flex;align-items:center;justify-content:center;font-size:.7em;color:#fff;text-align:center;position:relative}.timeline-segment.reunion{background:rgb(90,165,25)}.timeline-segment.viaje{background:#4682b4}.timeline-segment.despedida{background:#aaa}.timeline-marker{position:absolute;top:0;bottom:0;width:4px;background:#ff4500;z-index:10}.timeline-labels{display:flex;justify-content:space-between;margin-top:5px;font-size:.8em;color:#333}#copy-convoy-info,#copy-custom-info{padding:8px 12px;font-size:.9em;margin:10px 0;background:rgb(90,165,25);color:#fff;border:none;border-radius:6px;cursor:pointer}#copy-convoy-info:hover,#copy-custom-info:hover{opacity:.8}.copy-container,.custom-event{display:flex;flex-direction:column;align-items:flex-start;gap:10px}#copy-message{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);padding:10px 20px;background:linear-gradient(to right,#f0f0f0,#e0f0e0);border:2px solid rgb(90,165,25);border-radius:6px;color:rgb(90,165,25);font-weight:bold;text-align:center;display:none;z-index:1000;max-width:90%}@media (max-width:768px){.slot{width:calc(50% - 10px)}.timeline{justify-content:space-between}.timeline-bar{font-size:.6em}#timezone-select,#date-select,#event-name,#event-link,#event-description,#custom-date,#custom-time,#custom-event-name,#custom-event-link,#custom-event-description{font-size:.8em;padding:5px}#date-select,#custom-date,#custom-time{width:120px}#event-name,#event-link,#custom-event-name,#custom-event-link{width:100%}#copy-convoy-info,#copy-custom-info{font-size:.85em;padding:6px 10px}.input-row{flex-direction:column;align-items:flex-start}.time-info{flex-direction:column;gap:5px}}@media (max-width:480px){.slot{width:100%}.timeline-indicator,#date-display,#current-user-time{font-size:.9em}.timeline-bar{font-size:.5em}.event-timeline h3,.custom-event h3{font-size:.9em}}</style></head><body><header><nav><a href="index.html">Home</a><a href="pages/pc.html">Creador de Perfil</a><a href="pages/id.html">Licencia</a></nav><p id="t2">Horarios de Convoys</p></header><div class="contenedor"><div class="input-row"><label for="date-select">Fecha:</label><input type="date" id="date-select"><label for="timezone-select">Zona Horaria:</label><select id="timezone-select"><option value="auto" selected>Detectar automáticamente</option><option value="-6">UTC-6 (México, Guatemala, Honduras, Costa Rica)</option><option value="-5">UTC-5 (Colombia, Perú, Ecuador)</option><option value="-4.5">UTC-4:30 (Venezuela)</option><option value="-4">UTC-4 (Bolivia, Chile, Paraguay)</option><option value="-3">UTC-3 (Uruguay, Argentina, Brasil)</option><option value="1">UTC+1 (España)</option></select></div><div class="time-info"><div id="date-display"></div><div id="current-user-time"></div></div><div class="timeline-container"><div id="timeline-indicator" class="timeline-indicator"></div><p class="slots-explanation">Cada evento tiene una reunión de 30 minutos, seguida del convoy en ruta (50 minutos). La finalización dura 10 minutos, incluyendo agradecimientos y despedidas. Los últimos 5 minutos se solapan con la reunión del próximo evento.</p><div class="timeline" id="slots"></div><div class="copy-container"><div class="input-row"><input type="text" id="event-name" placeholder="Nombre del evento"><input type="text" id="event-link" placeholder="Enlace del evento"></div><label for="event-description">Descripción:</label><textarea id="event-description" placeholder="Descripción del evento" rows="2"></textarea><button id="copy-convoy-info">Código para Discord</button></div><div class="event-timeline"><h3>Línea de Tiempo del Evento Actual</h3><div id="timeline-bar" class="timeline-bar"></div><div id="timeline-labels" class="timeline-labels"></div></div><div class="custom-event"><h3>Crear Evento Personalizado</h3><div class="input-row"><label for="custom-date">Fecha:</label><input type="date" id="custom-date"><label for="custom-time">Hora de reunión:</label><input type="time" id="custom-time"></div><div id="custom-date-display"></div><div class="input-row"><input type="text" id="custom-event-name" placeholder="Nombre del evento"><input type="text" id="custom-event-link" placeholder="Enlace del evento"></div><label for="custom-event-description">Descripción:</label><textarea id="custom-event-description" placeholder="Descripción del evento" rows="2"></textarea><button id="copy-custom-info">Código para Discord</button></div></div><div id="copy-message">¡Información copiada al portapapeles!</div></div><footer><small>© LAG'S SPEED - CONVOYRAMA 2025</small></footer><script>const convoySlots=[{name:"Slot A",start:"23:00",duration:30},{name:"Slot B",start:"00:30",duration:30},{name:"Slot C",start:"02:00",duration:30},{name:"Slot D",start:"03:30",duration:30},{name:"Slot E",start:"05:00",duration:30},{name:"Slot F",start:"06:30",duration:30},{name:"Slot G",start:"08:00",duration:30}];const timezoneMap={'America/Mexico_City':-6,'America/Guatemala':-6,'America/Tegucigalpa':-6,'America/Costa_Rica':-6,'America/Bogota':-5,'America/Lima':-5,'America/Guayaquil':-5,'America/Caracas':-4.5,'America/La_Paz':-4,'America/Santiago':-4,'America/Asuncion':-4,'America/Montevideo':-3,'America/Buenos_Aires':-3,'America/Sao_Paulo':-3,'Europe/Madrid':1};let selectedSlot=null;let selectedDate=new Date();let userOffset=null;function pad(n){return n<10?"0"+n:n}function formatTime(d){return pad(d.getHours())+":"+pad(d.getMinutes())}function formatDateForDisplay(d){const months=["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"];return`${d.getDate()} de ${months[d.getMonth()]} de ${d.getFullYear()}`}function getUnixTimestamp(date){return Math.floor(date.getTime()/1000)}function showCopyMessage(message="¡Información copiada al portapapeles!"){const copyMessage=document.getElementById("copy-message");copyMessage.textContent=message;copyMessage.style.display="block";setTimeout(()=>{copyMessage.style.display="none"},2000)}async function fetchTimezone(){try{const timezone=Intl.DateTimeFormat().resolvedOptions().timeZone;console.log(`Navegador: timezone=${timezone}`);if(timezoneMap[timezone]){return{time:new Date(),offset:timezoneMap[timezone]}}}catch(error){console.warn('Error obteniendo zona horaria del navegador:',error)}try{const response=await fetch('https://worldtimeapi.org/api/ip',{mode:'cors'});const data=await response.json();const offset=data.utc_offset?parseFloat(data.utc_offset):null;const time=new Date(data.datetime);console.log(`WorldTimeAPI: offset=${offset}, time=${time}`);if(!isNaN(offset)){return{time,offset}}}catch(error){console.warn('Error fetching time from WorldTimeAPI:',error);showCopyMessage("No se pudo detectar la zona horaria. Por favor, selecciona una manualmente.")}const localOffset=-new Date().getTimezoneOffset()/60;console.log(`Fallback: offset=${localOffset}`);showCopyMessage("No se pudo detectar la zona horaria. Usando valor por defecto. Selecciona una manualmente si es necesario.");return{time:new Date(),offset:localOffset}}async function updateTime(){const select=document.getElementById("timezone-select");const savedOffset=localStorage.getItem('userOffset');const selValue=select.value;if(selValue!=="auto"&&savedOffset&&savedOffset===selValue){userOffset=parseFloat(selValue)}else{const{time,offset}=await fetchTimezone();userOffset=offset;const supportedOffsets=[-6,-5,-4.5,-4,-3,1];userOffset=supportedOffsets.reduce((prev,curr)=>Math.abs(curr-offset)<Math.abs(prev-offset)?curr:prev);if(selValue==="auto"){select.value=userOffset.toString()}}const utc=new Date().getTime()+(new Date().getTimezoneOffset()*60000);const userNow=new Date(utc+(userOffset*3600000));const offsetDisplay=userOffset%1===0?userOffset:userOffset.toFixed(1);document.getElementById("current-user-time").textContent=`Hora actual: ${formatTime(userNow)} (UTC${userOffset>=0?"+":""}${offsetDisplay})`;localStorage.setItem('userOffset',userOffset.toString());return{userNow,userOffset}}function renderSlots(userNow,userOffset){const slotsDiv=document.getElementById("slots");const timelineIndicator=document.getElementById("timeline-indicator");const timelineBar=document.getElementById("timeline-bar");const timelineLabels=document.getElementById("timeline-labels");const copyButton=document.getElementById("copy-convoy-info");const eventNameInput=document.getElementById("event-name");const eventLinkInput=document.getElementById("event-link");const eventDescriptionInput=document.getElementById("event-description");const dateDisplay=document.getElementById("date-display");const customDate=document.getElementById("custom-date");const customDateDisplay=document.getElementById("custom-date-display");slotsDiv.innerHTML="";timelineIndicator.innerHTML="";timelineBar.innerHTML="";timelineLabels.innerHTML="";dateDisplay.textContent=`Fecha seleccionada: ${formatDateForDisplay(selectedDate)}`;customDateDisplay.textContent=`Fecha seleccionada: ${formatDateForDisplay(new Date(customDate.value))}`;let nextSlotElem=null;let minDiff=Infinity;let nextSlotInfo=null;let currentSlot=null;convoySlots.forEach((slot,index)=>{const[hh,mm]=slot.start.split(":").map(Number);const utcBase=new Date(selectedDate);utcBase.setUTCHours(hh,mm,0,0);const localStart=new Date(utcBase.getTime()+userOffset*3600000);const convoyEnRuta=new Date(localStart.getTime()+30*60000);const finalizacion=new Date(convoyEnRuta.getTime()+50*60000);const finEvento=new Date(finalizacion.getTime()+10*60000);const nextReunion=new Date(finalizacion.getTime()+5*60000);const div=document.createElement("div");div.className="slot";div.innerHTML=`<h4>${slot.name}</h4><div class="event">Reunión: ${formatTime(localStart)}</div><div class="event">Salida: ${formatTime(convoyEnRuta)}</div><div class="range-bar"></div>`;div.onclick=()=>{document.querySelectorAll(".slot").forEach(s=>s.classList.remove("selected"));div.classList.add("selected");selectedSlot={name:slot.name,localStart,convoyEnRuta,finalizacion,date:new Date(selectedDate)};eventNameInput.value=`Convoy ${slot.name}`;eventLinkInput.value="https://convoyrama.github.io/events.html"};slotsDiv.appendChild(div);if(selectedDate.toDateString()===userNow.toDateString()){const diff=localStart-userNow;if(diff>0&&diff<minDiff){minDiff=diff;nextSlotElem=div;nextSlotInfo={name:slot.name,time:formatTime(localStart)}}const finEventoEnd=new Date(localStart.getTime()+90*60000);if(userNow>=localStart&&userNow<=finEventoEnd){currentSlot={slot,localStart,convoyEnRuta,finalizacion,finEvento,nextReunion}}});if(selectedDate.toDateString()===userNow.toDateString()){if(currentSlot){const{slot,localStart,convoyEnRuta,finalizacion,nextReunion}=currentSlot;const preConvoy=new Date(convoyEnRuta.getTime()-5*60000);const nextSlotIndex=convoySlots.findIndex(s=>s.name===slot.name)+1;const hasNextSlot=nextSlotIndex<convoySlots.length;if(userNow>=preConvoy&&userNow<convoyEnRuta){timelineIndicator.textContent=`¡Prepárate! El convoy de ${slot.name} está por salir a las ${formatTime(convoyEnRuta)}.`}else if(userNow>=convoyEnRuta&&userNow<finalizacion){timelineIndicator.textContent=`El convoy de ${slot.name} está en ruta.`}else if(userNow>=finalizacion&&userNow<nextReunion){timelineIndicator.textContent=`El convoy de ${slot.name} está en finalización.`}else if(userNow>=nextReunion&&userNow<=new Date(nextReunion.getTime()+5*60000)){let message=`El convoy de ${slot.name} ha finalizado.`;if(hasNextSlot){message+=` ¡Atención! La reunión de ${convoySlots[nextSlotIndex].name} está por empezar.`}timelineIndicator.textContent=message}}else if(nextSlotInfo){timelineIndicator.textContent=`Próximo: ${nextSlotInfo.name} - Reunión ${nextSlotInfo.time}`}else{timelineIndicator.textContent="No hay eventos próximos hoy"}}else{timelineIndicator.textContent=`Horarios para ${formatDateForDisplay(selectedDate)}`}if(selectedDate.toDateString()===userNow.toDateString()&&nextSlotElem){nextSlotElem.classList.add("highlight");nextSlotElem.scrollIntoView({behavior:"smooth",inline:"center"})}if(selectedDate.toDateString()===userNow.toDateString()&&currentSlot){const{slot,localStart,convoyEnRuta,finalizacion,finEvento}=currentSlot;const totalDuration=(finEvento-localStart)/60000;const elapsed=(userNow-localStart)/60000;const markerPosition=Math.min(Math.max((elapsed/totalDuration)*100,0),100);const segments=[{class:"reunion",width:(30/totalDuration)*100,label:`Reunión: ${formatTime(localStart)}`},{class:"viaje",width:(50/totalDuration)*100,label:`Salida: ${formatTime(convoyEnRuta)}`},{class:"despedida",width:(10/totalDuration)*100,label:`Finalización: ${formatTime(finalizacion)}`}];segments.forEach(segment=>{const div=document.createElement("div");div.className=`timeline-segment ${segment.class}`;div.style.width=`${segment.width}%`;div.textContent=segment.class==="viaje"?"Convoy en ruta":segment.label.split(': ')[0];timelineBar.appendChild(div);const label=document.createElement("div");label.textContent=segment.label;timelineLabels.appendChild(label)});if(markerPosition>=0&&markerPosition<=100){const marker=document.createElement("div");marker.className="timeline-marker";marker.style.left=`${markerPosition}%`;timelineBar.appendChild(marker)}}else{timelineBar.innerHTML=`<div style="width:100%;text-align:center;color:#333;">No hay evento activo en ${formatDateForDisplay(selectedDate)}</div>`}copyButton.onclick=()=>{if(!selectedSlot){showCopyMessage("Por favor, selecciona un slot primero.");return}const eventName=eventNameInput.value||`Convoy ${selectedSlot.name}`;const eventLink=eventLinkInput.value||"https://convoyrama.github.io/events.html";const eventDescription=eventDescriptionInput.value||"Sin descripción";const{localStart,convoyEnRuta,finalizacion,date}=selectedSlot;const convoyInfo=`[**${eventName} - ${formatDateForDisplay(date)}**](${eventLink})\nReunión: <t:${getUnixTimestamp(localStart)}:f>\nSalida: <t:${getUnixTimestamp(convoyEnRuta)}:f>\nFinalización: <t:${getUnixTimestamp(finalizacion)}:f>\nDescripción: ${eventDescription}`;navigator.clipboard.writeText(convoyInfo).then(()=>{showCopyMessage()}).catch(err=>console.error('Error al copiar:',err))};document.getElementById("copy-custom-info").onclick=()=>{const customDate=document.getElementById("custom-date").value;const customTime=document.getElementById("custom-time").value;const customEventName=document.getElementById("custom-event-name").value||"Evento Personalizado";const customEventLink=document.getElementById("custom-event-link").value||"https://convoyrama.github.io/events.html";const customEventDescription=document.getElementById("custom-event-description").value||"Sin descripción";if(!customDate||!customTime){showCopyMessage("Por favor, selecciona una fecha y hora.");return}const[hh,mm]=customTime.split(":").map(Number);const customDateObj=new Date(customDate);customDateObj.setHours(hh,mm,0,0);const utcBase=new Date(customDateObj.getTime()-userOffset*3600000);const localStart=new Date(utcBase.getTime()+userOffset*3600000);const convoyEnRuta=new Date(localStart.getTime()+30*60000);const finalizacion=new Date(convoyEnRuta.getTime()+50*60000);const convoyInfo=`[**${customEventName} - ${formatDateForDisplay(customDateObj)}**](${customEventLink})\nReunión: <t:${getUnixTimestamp(localStart)}:f>\nSalida: <t:${getUnixTimestamp(convoyEnRuta)}:f>\nFinalización: <t:${getUnixTimestamp(finalizacion)}:f>\nDescripción: ${customEventDescription}`;navigator.clipboard.writeText(convoyInfo).then(()=>{showCopyMessage()}).catch(err=>console.error('Error al copiar:',err))};customDate.onchange=()=>{const customDateObj=new Date(customDate.value);customDateDisplay.textContent=`Fecha seleccionada: ${formatDateForDisplay(customDateObj)}`}}async function init(){const dateSelect=document.getElementById("date-select");const customDate=document.getElementById("custom-date");selectedDate=new Date();dateSelect.value=selectedDate.toISOString().split('T')[0];customDate.value=selectedDate.toISOString().split('T')[0];document.getElementById("date-display").textContent=`Fecha seleccionada: ${formatDateForDisplay(selectedDate)}`;document.getElementById("custom-date-display").textContent=`Fecha seleccionada: ${formatDateForDisplay(selectedDate)}`;const{userNow,userOffset}=await updateTime();renderSlots(userNow,userOffset);dateSelect.addEventListener("change",async()=>{selectedDate=new Date(dateSelect.value);document.getElementById("date-display").textContent=`Fecha seleccionada: ${formatDateForDisplay(selectedDate)}`;const{userNow,userOffset}=await updateTime();renderSlots(userNow,userOffset)});document.getElementById("timezone-select").addEventListener("change",async()=>{const select=document.getElementById("timezone-select");localStorage.setItem('userOffset',select.value);const{userNow,userOffset}=await updateTime();renderSlots(userNow,userOffset)});setInterval(async()=>{const{userNow,userOffset}=await updateTime();renderSlots(userNow,userOffset)},600000)}window.onload=init;</script></body></html>
