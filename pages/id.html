<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="pageTitle">Convoyrama | Generador de Licencia</title>
  <meta name="description" content="Convoyrama">
  <link rel="stylesheet" href="../assets/style.css">
  <link rel="icon" href="../assets/images/favicon.png">
  <link rel="apple-touch-icon" href="../assets/images/favicon.png">
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
  <script src="https://twemoji.maxcdn.com/v/latest/twemoji.min.js" crossorigin="anonymous"></script>
  <style>
    header{padding:15px;text-align:center;position:relative;z-index:10;background:var(--accent-bg);border-bottom:1px solid var(--border)}header p{font-size:1.2em;text-shadow:none;font-family:Arial,sans-serif;font-weight:normal;margin:10px 0;color:#fff}nav{padding:10px;text-align:center}nav a,nav a:visited{text-decoration:none;margin:0 15px;font-size:1em;text-shadow:none;color:#fff}nav a:hover{text-decoration:underline}.contenedor{display:flex;gap:20px;padding:20px;align-items:flex-start;font-family:Arial,sans-serif}.panel{flex:1;max-width:300px;font-size:14px}.panel h3{margin:10px 0 5px;font-size:14px}.input-group{margin:6px 0}.toggle-group{display:flex;gap:10px;justify-content:space-between}.toggle-group .toggle-item{flex:1}canvas{border:1px solid #000;display:block;max-width:100%;height:auto}#preview{flex:1;text-align:center}button{padding:6px 12px;font-size:14px;margin-top:10px;background:rgb(90,165,25);color:#fff;border:none;border-radius:6px;cursor:pointer}button:hover{opacity:0.8}.hidden{display:none}#truckersmpStatus{font-size:12px;color:#555;margin-top:5px}.valid{color:green}.invalid{color:red}#colorSlider{width:80%;margin-top:5px;vertical-align:middle}#colorValue{display:inline-block;width:15%;text-align:right;font-size:14px;color:#555}
  </style>
</head>
<body>
  <header>
    <nav>
      <a href="../index.html">Home</a>
      <a href="pc.html">Creador de Perfil</a>
      <a href="id.html" id="navLicense">Licencia</a>
    </nav>
    <p id="headerTitle">Generador de Licencia de Conductor</p>
  </header>
  <div class="contenedor">
    <div class="panel">
      <div class="input-group">
        <label for="languageToggle">Idioma / Language / LÃ­ngua:</label><br>
        <select id="languageToggle" style="width:100%">
          <option value="es">EspaÃ±ol</option>
          <option value="en">English</option>
          <option value="pt">PortuguÃªs</option>
        </select>
      </div>
      <div class="input-group">
        <label id="fontLabel">Fuente: <span id="fontName">Open Sans</span></label>
      </div>
      <div class="input-group">
        <label for="colorSlider" id="colorLabel">Tono del fondo:</label><br>
        <input type="range" id="colorSlider" min="0" max="360" value="0" style="width:80%">
        <span id="colorValue">0Â°</span>
      </div>
      <div class="input-group">
        <label for="nombre" id="nameLabel">Nombre:</label><br>
        <input type="text" id="nombre" placeholder="Nombre / Name / Nome" required>
      </div>
      <div class="input-group hidden" id="nicknameGroup">
        <label for="nickname" id="nicknameLabel">TAG Ã‰pico:</label><br>
        <select id="nickname" style="width:100%">
          <option value="">Seleccione un TAG</option>
          <option value="ReyDelLag">ReyDelLag</option>
          <option value="FrenadorEnCurva">FrenadorEnCurva</option>
          <option value="SeÃ±orDelLagazo">SeÃ±orDelLagazo</option>
          <option value="BocinaLoca">BocinaLoca</option>
          <option value="CargadorDeDeudas">CargadorDeDeudas</option>
          <option value="CamioneroDelApagÃ³n">CamioneroDelApagÃ³n</option>
          <option value="FugitivoDeLaRuta">FugitivoDeLaRuta</option>
          <option value="MaestroDelPing">MaestroDelPing</option>
          <option value="ReyDeLaCarretera">ReyDeLaCarretera</option>
          <option value="LocoDelVolante">LocoDelVolante</option>
          <option value="SobrevivienteDelBan">SobrevivienteDelBan</option>
          <option value="BanEvasor">BanEvasor</option>
          <option value="FrenazoEstelar">FrenazoEstelar</option>
          <option value="TerrorDeCalais">TerrorDeCalais</option>
          <option value="LagLegendario">LagLegendario</option>
          <option value="SobrevivienteDeKirkenes">SobrevivienteDeKirkenes</option>
          <option value="MaestroDelReckless">MaestroDelReckless</option>
          <option value="PingParalizante">PingParalizante</option>
          <option value="RutaSinRetorno">RutaSinRetorno</option>
          <option value="VolanteEndemoniado">VolanteEndemoniado</option>
          <option value="AsDelReporte">AsDelReporte</option>
          <option value="ReyDeDuisburg">ReyDeDuisburg</option>
          <option value="ReyDeCalais">ReyDeCalais</option>
          <option value="KaosEnLaRuta">KaosEnLaRuta</option>
          <option value="CarreteraPerdida">CarreteraPerdida</option>
          <option value="FrenadorDePÃ¡nico">FrenadorDePÃ¡nico</option>
          <option value="CargaConDrama">CargaConDrama</option>
        </select>
      </div>
      <div class="input-group hidden" id="titleToggleGroup">
        <label for="titleToggle" id="titleToggleLabel">Usar tÃ­tulo cÃ³mico:</label><br>
        <input type="checkbox" id="titleToggle">
      </div>
      <div class="input-group">
        <label for="foto" id="photoLabel">Foto (Opcional):</label><br>
        <input type="file" id="foto" accept="image/*">
      </div>
      <div class="input-group">
        <label for="pais" id="countryLabel">PaÃ­s:</label><br>
        <select id="pais" style="width:100%" required>
          <option value="">Seleccione un paÃ­s / Select a country / Selecione um paÃ­s</option>
          <option value="AO|ğŸ‡¦ğŸ‡´|Angola|Angola|Angola">ğŸ‡¦ğŸ‡´ Angola</option>
          <option value="AR|ğŸ‡¦ğŸ‡·|Argentina|Argentina|Argentina">ğŸ‡¦ğŸ‡· Argentina</option>
          <option value="BO|ğŸ‡§ğŸ‡´|Bolivia|Bolivia|BolÃ­via">ğŸ‡§ğŸ‡´ Bolivia</option>
          <option value="BR|ğŸ‡§ğŸ‡·|Brasil|Brazil|Brasil">ğŸ‡§ğŸ‡· Brasil</option>
          <option value="BZ|ğŸ‡§ğŸ‡¿|Belice|Belize|Belize">ğŸ‡§ğŸ‡¿ Belice</option>
          <option value="CA|ğŸ‡¨ğŸ‡¦|CanadÃ¡|Canada|CanadÃ¡">ğŸ‡¨ğŸ‡¦ CanadÃ¡</option>
          <option value="CL|ğŸ‡¨ğŸ‡±|Chile|Chile|Chile">ğŸ‡¨ğŸ‡± Chile</option>
          <option value="CN|ğŸ‡¨ğŸ‡³|China|China|China">ğŸ‡¨ğŸ‡³ China</option>
          <option value="CO|ğŸ‡¨ğŸ‡´|Colombia|Colombia|ColÃ´mbia">ğŸ‡¨ğŸ‡´ Colombia</option>
          <option value="CR|ğŸ‡¨ğŸ‡·|Costa Rica|Costa Rica|Costa Rica">ğŸ‡¨ğŸ‡· Costa Rica</option>
          <option value="CU|ğŸ‡¨ğŸ‡º|Cuba|Cuba|Cuba">ğŸ‡¨ğŸ‡º Cuba</option>
          <option value="DE|ğŸ‡©ğŸ‡ª|Alemania|Germany|Alemanha">ğŸ‡©ğŸ‡ª Alemania</option>
          <option value="DO|ğŸ‡©ğŸ‡´|RepÃºblica Dominicana|Dominican Republic|RepÃºblica Dominicana">ğŸ‡©ğŸ‡´ RepÃºblica Dominicana</option>
          <option value="EC|ğŸ‡ªğŸ‡¨|Ecuador|Ecuador|Equador">ğŸ‡ªğŸ‡¨ Ecuador</option>
          <option value="ES|ğŸ‡ªğŸ‡¸|EspaÃ±a|Spain|Espanha">ğŸ‡ªğŸ‡¸ EspaÃ±a</option>
          <option value="FR|ğŸ‡«ğŸ‡·|Francia|France|FranÃ§a">ğŸ‡«ğŸ‡· Francia</option>
          <option value="GB|ğŸ‡¬ğŸ‡§|Reino Unido|United Kingdom (England/Scotland)|Reino Unido">ğŸ‡¬ğŸ‡§ Reino Unido</option>
          <option value="GT|ğŸ‡¬ğŸ‡¹|Guatemala|Guatemala|Guatemala">ğŸ‡¬ğŸ‡¹ Guatemala</option>
          <option value="GY|ğŸ‡¬ğŸ‡¾|Guyana|Guyana|Guiana">ğŸ‡¬ğŸ‡¾ Guyana</option>
          <option value="HN|ğŸ‡­ğŸ‡³|Honduras|Honduras|Honduras">ğŸ‡­ğŸ‡³ Honduras</option>
          <option value="IE|ğŸ‡®ğŸ‡ª|Irlanda|Ireland|Irlanda">ğŸ‡®ğŸ‡ª Irlanda</option>
          <option value="IT|ğŸ‡®ğŸ‡¹|Italia|Italy|ItÃ¡lia">ğŸ‡®ğŸ‡¹ Italia</option>
          <option value="JM|ğŸ‡¯ğŸ‡²|Jamaica|Jamaica|Jamaica">ğŸ‡¯ğŸ‡² Jamaica</option>
          <option value="JP|ğŸ‡¯ğŸ‡µ|JapÃ³n|Japan|JapÃ£o">ğŸ‡¯ğŸ‡µ JapÃ³n</option>
          <option value="MX|ğŸ‡²ğŸ‡½|MÃ©xico|Mexico|MÃ©xico">ğŸ‡²ğŸ‡½ MÃ©xico</option>
          <option value="MZ|ğŸ‡²ğŸ‡¿|Mozambique|Mozambique|MoÃ§ambique">ğŸ‡²ğŸ‡¿ Mozambique</option>
          <option value="NI|ğŸ‡³ğŸ‡®|Nicaragua|Nicaragua|NicarÃ¡gua">ğŸ‡³ğŸ‡® Nicaragua</option>
          <option value="PA|ğŸ‡µğŸ‡¦|PanamÃ¡|Panama|PanamÃ¡">ğŸ‡µğŸ‡¦ PanamÃ¡</option>
          <option value="PE|ğŸ‡µğŸ‡ª|PerÃº|Peru|Peru">ğŸ‡µğŸ‡ª PerÃº</option>
          <option value="PI|ğŸ´â€â˜ ï¸|Pirata|Pirate|Pirata">ğŸ´â€â˜ ï¸ Pirata</option>
          <option value="PL|ğŸ‡µğŸ‡±|Polonia|Poland|PolÃ´nia">ğŸ‡µğŸ‡± Polonia</option>
          <option value="PT|ğŸ‡µğŸ‡¹|Portugal|Portugal|Portugal">ğŸ‡µğŸ‡¹ Portugal</option>
          <option value="PY|ğŸ‡µğŸ‡¾|Paraguay|Paraguay|Paraguai">ğŸ‡µğŸ‡¾ Paraguay</option>
          <option value="RO|ğŸ‡·ğŸ‡´|Rumania|Romania|RomÃªnia">ğŸ‡·ğŸ‡´ Rumania</option>
          <option value="RU|ğŸ‡·ğŸ‡º|Rusia|Russia|RÃºssia">ğŸ‡·ğŸ‡º Rusia</option>
          <option value="SR|ğŸ‡¸ğŸ‡·|Surinam|Suriname|Suriname">ğŸ‡¸ğŸ‡· Surinam</option>
          <option value="SV|ğŸ‡¸ğŸ‡»|El Salvador|El Salvador|El Salvador">ğŸ‡¸ğŸ‡» El Salvador</option>
          <option value="TR|ğŸ‡¹ğŸ‡·|TurquÃ­a|Turkey|Turquia">ğŸ‡¹ğŸ‡· TurquÃ­a</option>
          <option value="UA|ğŸ‡ºğŸ‡¦|Ucrania|Ukraine|UcrÃ¢nia">ğŸ‡ºğŸ‡¦ Ucrania</option>
          <option value="US|ğŸ‡ºğŸ‡¸|Estados Unidos|United States|Estados Unidos">ğŸ‡ºğŸ‡¸ Estados Unidos</option>
          <option value="UY|ğŸ‡ºğŸ‡¾|Uruguay|Uruguay|Uruguai" selected>ğŸ‡ºğŸ‡¾ Uruguay</option>
          <option value="VE|ğŸ‡»ğŸ‡ª|Venezuela|Venezuela|Venezuela">ğŸ‡»ğŸ‡ª Venezuela</option>
        </select>
      </div>
      <div class="input-group" id="empresaGroup">
        <label for="empresa" id="companyLabel">Empresa:</label><br>
        <select id="empresa" style="width:100%" onchange="updForm()">
          <option value="LS" selected>LS</option>
          <option value="CN">CN</option>
          <option value="TCS">TCS</option>
          <option value="Otro">Otra</option>
        </select>
      </div>
      <div class="input-group hidden" id="empresaLinkGroup">
        <label for="empresaLink" id="companyLinkLabel">Enlace Perfil Empresa en TMP:</label><br>
        <input type="text" id="empresaLink" placeholder="TruckersMP Company Profile Link" required>
      </div>
      <div class="input-group">
        <label for="truckersmpLink" id="truckersmpLinkLabel">Enlace Perfil en TMP:</label><br>
        <input type="text" id="truckersmpLink" placeholder="TruckersMP Profile Link" required>
        <div id="truckersmpStatus"></div>
      </div>
      <div class="input-group toggle-group">
        <div class="toggle-item">
          <label for="promodsToggle">ProMods:</label><br>
          <input type="checkbox" id="promodsToggle">
        </div>
        <div class="toggle-item">
          <label for="dbusworldToggle">DBUS:</label><br>
          <input type="checkbox" id="dbusworldToggle">
        </div>
      </div>
    </div>
    <div id="preview">
      <canvas id="canvas" width="800" height="500"></canvas>
      <br>
      <a id="descargar" download="driver_license.png">
        <button id="botonDescargar">Descargar Licencia</button>
      </a>
    </div>
  </div>
  <footer>
    <small>Â© LAG'S SPEED - CONVOYRAMA 2025 - versiÃ³n 1.8.4-testing</small>
  </footer>
  <script>
    function getTwemoji(e,s){return new Promise(r=>{const i=new Image();i.onload=()=>{r(i)};i.onerror=()=>{r(null)};i.src=twemoji.parse(e,{folder:'svg',ext:'.svg'}).match(/src="([^"]+)"/)[1];i.crossOrigin="anonymous"})}
    const cvs=document.getElementById("canvas"),ctx=cvs.getContext("2d"),cfg={color:"white",flagSize:80,photoX:45,photoY:80,labelX:100,colonX:130,textX:295,textY:334,qrX:573,qrY:101,flagX:625,flagY:206,font:"'Open Sans', Arial, sans-serif",defaultPhotoSize:192,qrSize:100,qrSpacing:10,promodsX:20,promodsY:334,dbusworldX:20,dbusworldY:394,logoWidth:67,logoHeight:50},trans={es:{pageTitle:"Convoyrama | Generador de Licencia",headerTitle:"Generador de Licencia de Conductor",navLicense:"Licencia",fontLabel:"Fuente: ",nameLabel:"Nombre:",nicknameLabel:"TAG Ã‰pico:",titleToggleLabel:"Usar tÃ­tulo cÃ³mico:",photoLabel:"Foto (Opcional):",countryLabel:"PaÃ­s:",companyLabel:"Empresa:",companyOther:"Otra",companyLinkLabel:"Enlace Perfil Empresa en TMP:",truckersmpLinkLabel:"Enlace Perfil en TMP:",validLink:"Enlace vÃ¡lido",invalidLink:"Enlace invÃ¡lido: debe ser https://truckersmp.com/user/[nÃºmero]",downloadButton:"Descargar Licencia",canvasName:"Nombre :",canvasLicenseNo:"NÃºm. Licencia :",canvasDate:"Fecha :",canvasCountry:"PaÃ­s :",canvasTag:"TAG :",titleNormal:"PERMISO DE CONDUCCIÃ“N INTERNACIONAL",titleComedic:"PERMISO PARA CHOCAR EN CONVOY",countryPlaceholder:"Seleccione un paÃ­s",colorLabel:"Tono del fondo:"},en:{pageTitle:"Convoyrama | Driver License Generator",headerTitle:"Driver License Generator",navLicense:"License",fontLabel:"Font: ",nameLabel:"Name:",nicknameLabel:"Epic TAG:",titleToggleLabel:"Use comedic title:",photoLabel:"Photo (Optional):",countryLabel:"Country:",companyLabel:"Company:",companyOther:"Other",companyLinkLabel:"TruckersMP Company Profile Link:",truckersmpLinkLabel:"TruckersMP Profile Link:",validLink:"Valid link",invalidLink:"Invalid link: must be https://truckersmp.com/user/[number]",downloadButton:"Download License",canvasName:"Name :",canvasLicenseNo:"License No. :",canvasDate:"Date :",canvasCountry:"Country :",canvasTag:"TAG :",titleNormal:"INTERNATIONAL DRIVING LICENSE",titleComedic:"CONVOY CRASHING PERMIT",countryPlaceholder:"Select a country",colorLabel:"Background hue:"},pt:{pageTitle:"Convoyrama | Gerador de LicenÃ§a",headerTitle:"Gerador de LicenÃ§a de Motorista",navLicense:"LicenÃ§a",fontLabel:"Fonte: ",nameLabel:"Nome:",nicknameLabel:"TAG Ã‰pico:",titleToggleLabel:"Usar tÃ­tulo cÃ´mico:",photoLabel:"Foto (Opcional):",countryLabel:"PaÃ­s:",companyLabel:"Empresa:",companyOther:"Outra",companyLinkLabel:"Link do Perfil da Empresa no TruckersMP:",truckersmpLinkLabel:"Link do Perfil no TruckersMP:",validLink:"Link vÃ¡lido",invalidLink:"Link invÃ¡lido: deve ser https://truckersmp.com/user/[nÃºmero]",downloadButton:"Baixar LicenÃ§a",canvasName:"Nome :",canvasLicenseNo:"NÂº da LicenÃ§a :",canvasDate:"Data :",canvasCountry:"PaÃ­s :",canvasTag:"TAG :",titleNormal:"LICENÃ‡A INTERNACIONAL DE CONDUÃ‡ÃƒO",titleComedic:"PERMISSÃƒO PARA BATER EM CONVOI",countryPlaceholder:"Selecione um paÃ­s",colorLabel:"Tom do fundo:"}},nameInp=document.getElementById("nombre"),fotoInp=document.getElementById("foto"),paisInp=document.getElementById("pais"),nickInp=document.getElementById("nickname"),empInp=document.getElementById("empresa"),empLinkInp=document.getElementById("empresaLink"),tmpLinkInp=document.getElementById("truckersmpLink"),tmpStatus=document.getElementById("truckersmpStatus"),empGroup=document.getElementById("empresaGroup"),empLinkGroup=document.getElementById("empresaLinkGroup"),nickGroup=document.getElementById("nicknameGroup"),titleGroup=document.getElementById("titleToggleGroup"),titleTog=document.getElementById("titleToggle"),promodsTog=document.getElementById("promodsToggle"),dbusTog=document.getElementById("dbusworldToggle"),langTog=document.getElementById("languageToggle"),colorSld=document.getElementById("colorSlider"),colorVal=document.getElementById("colorValue");let usrImg=null,nickUnlock=localStorage.getItem("nicknameUnlocked")==="true",cacheDate=null,lastFetch=0,DATE_CACHE=60*1000,curLang="es";
    async function getDate(){const now=Date.now();if(cacheDate&&now-lastFetch<DATE_CACHE)return cacheDate;const apis=[{url:'https://worldtimeapi.org/api/timezone/Etc/UTC',parse:d=>{const dt=new Date(d.datetime);return{day:dt.getDate().toString().padStart(2,"0"),month:(dt.getMonth()+1).toString().padStart(2,"0"),year:dt.getFullYear()}}},{url:'https://timeapi.io/api/Time/current/utc',parse:d=>({day:d.day.toString().padStart(2,"0"),month:d.month.toString().padStart(2,"0"),year:d.year})},{url:'https://worldclockapi.herokuapp.com/api/json/utc/now',parse:d=>{const dt=new Date(d.currentDateTime);return{day:dt.getDate().toString().padStart(2,"0"),month:(dt.getMonth()+1).toString().padStart(2,"0"),year:dt.getFullYear()}}}];for(const api of apis)try{const res=await fetch(api.url),data=await res.json(),{day,month,year}=api.parse(data);cacheDate=`${day}/${month}/${year}`;lastFetch=now;return cacheDate}catch(e){}const dt=new Date(),day=dt.getDate().toString().padStart(2,"0"),month=(dt.getMonth()+1).toString().padStart(2,"0"),year=dt.getFullYear();cacheDate=`${day}/${month}/${year}`;lastFetch=now;return cacheDate}
    function updLang(lang){curLang=lang;const t=trans[lang];document.getElementById("pageTitle").textContent=t.pageTitle;document.getElementById("headerTitle").textContent=t.headerTitle;document.getElementById("navLicense").textContent=t.navLicense;document.getElementById("fontLabel").innerHTML=t.fontLabel+'<span id="fontName">Open Sans</span>';document.getElementById("nameLabel").textContent=t.nameLabel;document.getElementById("nicknameLabel").textContent=t.nicknameLabel;document.getElementById("titleToggleLabel").textContent=t.titleToggleLabel;document.getElementById("photoLabel").textContent=t.photoLabel;document.getElementById("countryLabel").textContent=t.countryLabel;document.getElementById("companyLabel").textContent=t.companyLabel;document.getElementById("companyLinkLabel").textContent=t.companyLinkLabel;document.getElementById("truckersmpLinkLabel").textContent=t.truckersmpLinkLabel;document.getElementById("colorLabel").textContent=t.colorLabel;document.getElementById("botonDescargar").textContent=t.downloadButton;paisInp.options[0].text=t.countryPlaceholder;const empSel=empInp;for(let i=0;i<empSel.options.length;i++)if(empSel.options[i].value==="Otro")empSel.options[i].text=t.companyOther;const countries=[{code:"AO",flag:"ğŸ‡¦ğŸ‡´",es:"Angola",en:"Angola",pt:"Angola"},{code:"AR",flag:"ğŸ‡¦ğŸ‡·",es:"Argentina",en:"Argentina",pt:"Argentina"},{code:"BO",flag:"ğŸ‡§ğŸ‡´",es:"Bolivia",en:"Bolivia",pt:"BolÃ­via"},{code:"BR",flag:"ğŸ‡§ğŸ‡·",es:"Brasil",en:"Brazil",pt:"Brasil"},{code:"BZ",flag:"ğŸ‡§ğŸ‡¿",es:"Belice",en:"Belize",pt:"Belize"},{code:"CA",flag:"ğŸ‡¨ğŸ‡¦",es:"CanadÃ¡",en:"Canada",pt:"CanadÃ¡"},{code:"CL",flag:"ğŸ‡¨ğŸ‡±",es:"Chile",en:"Chile",pt:"Chile"},{code:"CN",flag:"ğŸ‡¨ğŸ‡³",es:"China",en:"China",pt:"China"},{code:"CO",flag:"ğŸ‡¨ğŸ‡´",es:"Colombia",en:"Colombia",pt:"ColÃ´mbia"},{code:"CR",flag:"ğŸ‡¨ğŸ‡·",es:"Costa Rica",en:"Costa Rica",pt:"Costa Rica"},{code:"CU",flag:"ğŸ‡¨ğŸ‡º",es:"Cuba",en:"Cuba",pt:"Cuba"},{code:"DE",flag:"ğŸ‡©ğŸ‡ª",es:"Alemania",en:"Germany",pt:"Alemanha"},{code:"DO",flag:"ğŸ‡©ğŸ‡´",es:"RepÃºblica Dominicana",en:"Dominican Republic",pt:"RepÃºblica Dominicana"},{code:"EC",flag:"ğŸ‡ªğŸ‡¨",es:"Ecuador",en:"Ecuador",pt:"Equador"},{code:"ES",flag:"ğŸ‡ªğŸ‡¸",es:"EspaÃ±a",en:"Spain",pt:"Espanha"},{code:"FR",flag:"ğŸ‡«ğŸ‡·",es:"Francia",en:"France",pt:"FranÃ§a"},{code:"GB",flag:"ğŸ‡¬ğŸ‡§",es:"Reino Unido",en:"United Kingdom (England/Scotland)",pt:"Reino Unido"},{code:"GT",flag:"ğŸ‡¬ğŸ‡¹",es:"Guatemala",en:"Guatemala",pt:"Guatemala"},{code:"GY",flag:"ğŸ‡¬ğŸ‡¾",es:"Guyana",en:"Guyana",pt:"Guiana"},{code:"HN",flag:"ğŸ‡­ğŸ‡³",es:"Honduras",en:"Honduras",pt:"Honduras"},{code:"IE",flag:"ğŸ‡®ğŸ‡ª",es:"Irlanda",en:"Ireland",pt:"Irlanda"},{code:"IT",flag:"ğŸ‡®ğŸ‡¹",es:"Italia",en:"Italy",pt:"ItÃ¡lia"},{code:"JM",flag:"ğŸ‡¯ğŸ‡²",es:"Jamaica",en:"Jamaica",pt:"Jamaica"},{code:"JP",flag:"ğŸ‡¯ğŸ‡µ",es:"JapÃ³n",en:"Japan",pt:"JapÃ£o"},{code:"MX",flag:"ğŸ‡²ğŸ‡½",es:"MÃ©xico",en:"Mexico",pt:"MÃ©xico"},{code:"MZ",flag:"ğŸ‡²ğŸ‡¿",es:"Mozambique",en:"Mozambique",pt:"MoÃ§ambique"},{code:"NI",flag:"ğŸ‡³ğŸ‡®",es:"Nicaragua",en:"Nicaragua",pt:"NicarÃ¡gua"},{code:"PA",flag:"ğŸ‡µğŸ‡¦",es:"PanamÃ¡",en:"Panama",pt:"PanamÃ¡"},{code:"PE",flag:"ğŸ‡µğŸ‡ª",es:"PerÃº",en:"Peru",pt:"Peru"},{code:"PI",flag:"ğŸ´â€â˜ ï¸",es:"Pirata",en:"Pirate",pt:"Pirata"},{code:"PL",flag:"ğŸ‡µğŸ‡±",es:"Polonia",en:"Poland",pt:"PolÃ´nia"},{code:"PT",flag:"ğŸ‡µğŸ‡¹",es:"Portugal",en:"Portugal",pt:"Portugal"},{code:"PY",flag:"ğŸ‡µğŸ‡¾",es:"Paraguay",en:"Paraguay",pt:"Paraguai"},{code:"RO",flag:"ğŸ‡·ğŸ‡´",es:"Rumania",en:"Romania",pt:"RomÃªnia"},{code:"RU",flag:"ğŸ‡·ğŸ‡º",es:"Rusia",en:"Russia",pt:"RÃºssia"},{code:"SR",flag:"ğŸ‡¸ğŸ‡·",es:"Surinam",en:"Suriname",pt:"Suriname"},{code:"SV",flag:"ğŸ‡¸ğŸ‡»",es:"El Salvador",en:"El Salvador",pt:"El Salvador"},{code:"TR",flag:"ğŸ‡¹ğŸ‡·",es:"TurquÃ­a",en:"Turkey",pt:"Turquia"},{code:"UA",flag:"ğŸ‡ºğŸ‡¦",es:"Ucrania",en:"Ukraine",pt:"UcrÃ¢nia"},{code:"US",flag:"ğŸ‡ºğŸ‡¸",es:"Estados Unidos",en:"United States",pt:"Estados Unidos"},{code:"UY",flag:"ğŸ‡ºğŸ‡¾",es:"Uruguay",en:"Uruguay",pt:"Uruguai"},{code:"VE",flag:"ğŸ‡»ğŸ‡ª",es:"Venezuela",en:"Venezuela",pt:"Venezuela"}];for(let i=1;i<paisInp.options.length;i++){const opt=paisInp.options[i],ctry=countries.find(c=>c.code===opt.value.split("|")[0]);opt.text=`${ctry.flag} ${ctry[lang]}`;opt.value=`${ctry.code}|${ctry.flag}|${ctry[lang]}`;}const link=tmpLinkInp.value.trim();if(link)valTmpLink(link);debGenImg()}
    function genLicNum(n,p,l){const cc=p.split("|")[0].substring(0,2)||"XX",m=l.match(/truckersmp\.com\/user\/(\d+)/);return m?`${cc}${m[1]}`:""}
    function valTmpLink(l){const r=/^https:\/\/truckersmp\.com\/user\/\d+$/,t=trans[curLang];if(!r.test(l)){tmpStatus.textContent=t.invalidLink;tmpStatus.className="invalid";return false}tmpStatus.textContent=t.validLink;tmpStatus.className="valid";return true}
    function debounce(f,w){let t;return function(...a){const l=()=>{clearTimeout(t);f(...a);};clearTimeout(t);t=setTimeout(l,w);}}
    function saveCtry(){localStorage.setItem("defaultCountry",paisInp.value)}
    function loadCtry(){const s=localStorage.getItem("defaultCountry");if(s)paisInp.value=s}
    function updForm(){const emp=empInp.value;empLinkGroup.classList.toggle("hidden",emp!=="Otro");const clrMap={LS:260,CN:340,TCS:200,Otro:colorSld.value};const newClr=clrMap[emp]||0;colorSld.value=newClr;colorVal.textContent=`${newClr}Â°`;const n=nameInp.value.toLowerCase().trim();if(["convoyrama","nocturnoverso"].includes(n)){nickUnlock=true;localStorage.setItem("nicknameUnlocked","true")}nickGroup.classList.toggle("hidden",!nickUnlock);titleGroup.classList.toggle("hidden",!nickUnlock);debGenImg()}
    let lastState={};function getState(){return{nombre:nameInp.value,pais:paisInp.value,nickname:nickInp.value,empresa:empInp.value,truckersmpLink:tmpLinkInp.value,empresaLink:empLinkInp.value,titleToggle:titleTog.checked,promodsToggle:promodsTog.checked,dbusworldToggle:dbusTog.checked,userImage:usrImg?usrImg.src:null,language:curLang,colorHue:colorSld.value}}
    async function genImg(){const state=getState();if(JSON.stringify(state)===JSON.stringify(lastState))return;lastState=state;const t=trans[curLang],n=nameInp.value||(curLang==="es"?"Sin nombre":curLang==="en"?"No name":"Sem nome"),p=paisInp.value.split("|"),cc=p[0]||"XX",flag=p[1]||"",cn=p[2]||(curLang==="es"?"Sin paÃ­s":curLang==="en"?"No country":"Sem paÃ­s"),nick=nickInp.value||"",emp=empInp.value,tmpLink=tmpLinkInp.value.trim(),empLink=empLinkInp.value.trim(),isTmpValid=tmpLink?valTmpLink(tmpLink):false,hue=parseInt(colorSld.value);if(cvs.width!==800||cvs.height!==500){cvs.width=800;cvs.height=500}ctx.clearRect(0,0,cvs.width,cvs.height);ctx.font=null;ctx.fillStyle=null;ctx.textAlign="start";ctx.textBaseline="alphabetic";ctx.shadowColor="transparent";ctx.globalCompositeOperation="source-over";ctx.filter="none";const tmpSrc={LS:'./assets/images/license_template_ls.png',TCS:'./assets/images/license_template_tcs.png',CN:'./assets/images/license_template_cn.png',Otro:'./assets/images/license_template_otro.png'}[emp]||'./assets/images/license_template_otro.png',tmpImg=new Image();tmpImg.src=tmpSrc;const empSrc={LS:'./assets/images/lsb.png',TCS:'./assets/images/tcsb.png',CN:'./assets/images/cnb.png',Otro:'./assets/images/otrosb.png'}[emp]||'./assets/images/otrosb.png',empLayer=new Image();empLayer.src=empSrc;const langSrc={es:'./assets/images/es.png',en:'./assets/images/en.png',pt:'./assets/images/pt.png'}[curLang],langLayer=new Image();langLayer.src=langSrc;const[tmpI,empI,langI,silImg,flagImg,idImg,leftQr,promodsImg,dbusImg]=await Promise.all([new Promise(r=>{tmpImg.onload=()=>{r(tmpImg)};tmpImg.onerror=()=>{r(null)}}),new Promise(r=>{empLayer.onload=()=>{r(empLayer)};empLayer.onerror=()=>{r(null)}}),new Promise(r=>{langLayer.onload=()=>{r(langLayer)};langLayer.onerror=()=>{r(null)}}),usrImg?Promise.resolve(null):getTwemoji("ğŸ‘¤",cfg.defaultPhotoSize),flag?getTwemoji(flag,cfg.flagSize):Promise.resolve(null),isTmpValid?new Promise(r=>{const i=new Image();i.src="./assets/images/id.svg";i.onload=()=>{r(i)};i.onerror=()=>{r(null)}}):Promise.resolve(null),isTmpValid&&(emp==="LS"||emp==="CN"||emp==="TCS")?new Promise(r=>{const i=new Image();i.src=`./assets/images/qr${emp.toLowerCase()}.svg`;i.onload=()=>{r(i)};i.onerror=()=>{r(null)}}):isTmpValid&&empLink?new Promise(r=>{const qr=new QRious({value:empLink,size:cfg.qrSize,level:'H'}),qc=document.createElement("canvas");qc.width=cfg.qrSize;qc.height=cfg.qrSize;const qctx=qc.getContext("2d");qctx.drawImage(qr.canvas,0,0);r(qc)}):Promise.resolve(null),promodsTog.checked?new Promise(r=>{const i=new Image();i.src="./assets/images/promods.png";i.onload=()=>{r(i)};i.onerror=()=>{r(null)}}):Promise.resolve(null),dbusTog.checked?new Promise(r=>{const i=new Image();i.src="./assets/images/dbusworld.png";i.onload=()=>{r(i)};i.onerror=()=>{r(null)}}):Promise.resolve(null)]);if(tmpI){ctx.filter=`hue-rotate(${hue}deg)`;ctx.drawImage(tmpI,0,0,cvs.width,cvs.height);ctx.filter="none"}else{ctx.fillStyle="#fff";ctx.fillRect(0,0,cvs.width,cvs.height)}if(empI)ctx.drawImage(empI,0,0,cvs.width,cvs.height);if(langI)ctx.drawImage(langI,0,0,cvs.width,cvs.height);if(usrImg)ctx.drawImage(usrImg,cfg.photoX,cfg.photoY,cfg.defaultPhotoSize,cfg.defaultPhotoSize);else if(silImg)ctx.drawImage(silImg,cfg.photoX,cfg.photoY,cfg.defaultPhotoSize,cfg.defaultPhotoSize);if(flagImg)ctx.drawImage(flagImg,cfg.flagX-cfg.flagSize/2,cfg.flagY,cfg.flagSize,cfg.flagSize);const date=await getDate();ctx.font=`bold 24px ${cfg.font}`;ctx.fillStyle=cfg.color;const lh=24*1.2;ctx.fillText(t.canvasName,cfg.labelX,cfg.textY);ctx.fillText(t.canvasLicenseNo,cfg.labelX,cfg.textY+lh);ctx.fillText(t.canvasDate,cfg.labelX,cfg.textY+lh*2);ctx.fillText(t.canvasCountry,cfg.labelX,cfg.textY+lh*3);if(nickUnlock&&nick)ctx.fillText(t.canvasTag,cfg.labelX,cfg.textY+lh*4);ctx.fillText(n,cfg.textX,cfg.textY);if(n&&n.trim()!==""&&paisInp.value&&isTmpValid){const licNum=genLicNum(n,paisInp.value,tmpLink);if(licNum)ctx.fillText(licNum,cfg.textX,cfg.textY+lh)}ctx.fillText(date,cfg.textX,cfg.textY+lh*2);ctx.fillText(cn,cfg.textX,cfg.textY+lh*3);if(nickUnlock&&nick)ctx.fillText(nick,cfg.textX,cfg.textY+lh*4);if(promodsImg&&promodsTog.checked)ctx.drawImage(promodsImg,cfg.promodsX,cfg.promodsY,cfg.logoWidth,cfg.logoHeight);if(dbusImg&&dbusTog.checked){const dbusY=promodsTog.checked?cfg.dbusworldY:cfg.promodsY;ctx.drawImage(dbusImg,cfg.dbusworldX,dbusY,cfg.logoWidth,cfg.logoHeight)}const starMap={"https://truckersmp.com/user/627943":2,"https://truckersmp.com/user/5441056":1,"https://truckersmp.com/user/5429829":3,"https://truckersmp.com/user/5408877":1,"https://truckersmp.com/user/5379466":3,"https://truckersmp.com/user/5861450":2,"https://truckersmp.com/user/4690862":3,"https://truckersmp.com/user/1432064":2,"https://truckersmp.com/user/4890784":2},stars=starMap[tmpLink]||0;if(stars>0){ctx.font=`bold 24px ${cfg.font}`;ctx.fillStyle="#FFD700";ctx.textAlign="right";const starX=cvs.width-20;for(let i=0;i<stars;i++)ctx.fillText("â˜…",starX,cfg.promodsY+i*24)}const title=nickUnlock&&titleTog.checked?t.titleComedic:t.titleNormal,ty=cvs.height-5;ctx.font=`bold 22px ${cfg.font}`;ctx.fillStyle="rgb(240,240,240)";ctx.textAlign="center";ctx.textBaseline="bottom";ctx.shadowColor="rgb(0,0,0)";ctx.shadowOffsetX=1;ctx.shadowOffsetY=1;ctx.shadowBlur=2;ctx.fillText(title,cvs.width/2,ty);ctx.shadowColor="transparent";if(isTmpValid){const qrP=new QRious({value:tmpLink,size:cfg.qrSize,level:'H'}),qrCvs=document.createElement("canvas");qrCvs.width=cfg.qrSize;qrCvs.height=cfg.qrSize;const qrCtx=qrCvs.getContext("2d");qrCtx.drawImage(qrP.canvas,0,0);ctx.drawImage(qrCvs,cfg.qrX,cfg.qrY,cfg.qrSize,cfg.qrSize);if(idImg)ctx.drawImage(idImg,cfg.qrX+cfg.qrSize+cfg.qrSpacing,cfg.qrY,cfg.qrSize,cfg.qrSize);if(leftQr)ctx.drawImage(leftQr,cfg.qrX-cfg.qrSize-cfg.qrSpacing,cfg.qrY,cfg.qrSize,cfg.qrSize)}const link=document.getElementById("descargar");link.href=cvs.toDataURL("image/png");link.download=`driver_license_${n}_${emp}.png`}
    const debGenImg=debounce(genImg,100);fotoInp.addEventListener("change",e=>{const f=e.target.files[0];if(f){const r=new FileReader();r.onload=ev=>{usrImg=new Image();usrImg.src=ev.target.result;usrImg.onload=debGenImg};r.readAsDataURL(f)}else{usrImg=null;debGenImg()}});tmpLinkInp.addEventListener("input",()=>{const l=tmpLinkInp.value.trim();if(l)valTmpLink(l);else{tmpStatus.textContent="";tmpStatus.className=""}debGenImg()});langTog.addEventListener("change",()=>{updLang(langTog.value)});colorSld.addEventListener("input",()=>{colorVal.textContent=`${colorSld.value}Â°`;debGenImg()});[nameInp,paisInp,nickInp,empLinkInp,titleTog,promodsTog,dbusTog].forEach(el=>el.addEventListener("input",debGenImg));paisInp.addEventListener("change",saveCtry);empInp.addEventListener("change",updForm);nameInp.addEventListener("input",updForm);async function init(){loadCtry();nickGroup.classList.toggle("hidden",!nickUnlock);titleGroup.classList.toggle("hidden",!nickUnlock);updLang(curLang);updForm();await debGenImg()}init();
  </script>
</body>
</html>
